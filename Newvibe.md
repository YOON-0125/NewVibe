# NewVibe 프로젝트 분석 및 개발 계획

## 📋 프로젝트 현황 분석

### 현재 상태 (업데이트됨)
- **프로젝트 상태**: 📊 **65% 완료** - 핵심 게임플레이 구현 완료
- **현재 코드**: 완전한 게임 루프 동작 (플레이어 이동, 적 스폰, 무기 시스템, UI)
- **기술 스택**: React + TypeScript + PixiJS 7.4.3 (완전 통합됨)
- **개발 환경**: React Scripts 5.0.1, Tailwind CSS (모바일 반응형 완료)

### 📊 주요 구현 완료 사항
✅ **완료**: GameEngine, Player/Enemy 시스템, 궤도탄/직선탄 무기, 경험치/레벨업, 완전한 UI  
⚠️ **부분완료**: 업그레이드 시스템 연동, 게임오버 UI 연결  
❌ **미완료**: 방어막 무기, 유물 시스템, 데이터 저장, Capacitor 변환

### 목표 변경사항
- **이전**: 한국 테마 roguelike 게임 (PixiJS + 복잡한 시스템)
- **현재**: 뱀파이어 서바이벌 단순화 게임 (모바일 우선)
- **렌더링**: PixiJS 유지 (HTML5 Canvas 대신)
- **플랫폼**: 웹 → Capacitor 모바일 앱 변환

## 🎯 프로젝트 요구사항 정리

### 핵심 게임플레이
1. **플레이어 조작**: 터치/클릭으로 이동만 (탭 투 무브)
2. **자동 공격**: 3종 무기 시스템 (궤도탄/직선탄/방어막)
3. **생존 목표**: 15분 생존
4. **진행 시스템**: 경험치 → 레벨업 → 3가지 업그레이드 선택
5. **메타 진행**: 클리어 시 유물 획득, 난이도 25% 증가

### 기술적 요구사항
- **렌더링**: PixiJS (게임 영역) + React DOM (UI 오버레이)
- **상태관리**: React useState/useReducer
- **모바일 최적화**: 375px 기준 모바일 우선 설계
- **성능**: 30fps 제한, 오브젝트 풀링, 화면 밖 렌더링 스킵
- **저장**: LocalStorage 기반

### UI/UX 설계 (ui_layout.md 기준)
```
┌─────────────────┐ 375px
│ 상태 정보 (50px) │ ← HP, 레벨, 타이머, 점수
├─────────────────┤
│ 체력바 (30px)   │ ← HP 진행바
├─────────────────┤
│ 경험치바 (25px) │ ← XP 진행바
├─────────────────┤
│ 스킬표시 (40px) │ ← 무기 아이콘+레벨
├─────────────────┤
│ 게임영역 (455px)│ ← PixiJS 렌더링 영역
├─────────────────┤
│ 하단버튼 (60px) │ ← 일시정지, 홈, 설정
└─────────────────┘
```

## 🗓 4주 개발 계획

### 1주차: 기본 게임 구조 (Week 1)
**목표**: 기본 게임 루프와 플레이어 이동 구현

#### 우선순위 1 (P1) - 필수 구현
- [x] **PixiJS 게임 엔진 초기화**
  - [x] GameEngine 클래스 구현
  - [x] 캔버스 설정 및 React 통합
  - [x] 기본 씬 관리자 구현

- [x] **플레이어 시스템**
  - [x] Player 클래스 구현 (위치, 이동, 렌더링)
  - [x] 터치/마우스 입력 처리 (탭 투 무브)
  - [x] 플레이어 이동 애니메이션

- [x] **기본 적 시스템**
  - [x] Enemy 클래스 구현
  - [x] 간단한 적 AI (플레이어 추적)
  - [x] 적 스폰 시스템 (타이머 기반)

#### 우선순위 2 (P2) - 주요 기능
- [x] **충돌 감지 시스템**
  - [x] AABB 충돌 감지 구현
  - [x] 플레이어-적 충돌 처리
  - [x] 투사체-적 충돌 처리

- [x] **기본 무기 시스템**
  - [x] 궤도탄 무기 구현 (플레이어 주변 회전)
  - [x] 자동 타겟팅 시스템

### 2주차: 게임 루프 완성 (Week 2)
**목표**: 완전한 게임 루프와 레벨업 시스템

#### 우선순위 1 (P1) - 필수 구현
- [x] **경험치 시스템**
  - [x] 경험치 드롭 구현
  - [x] 경험치 수집 메커니즘
  - [x] 레벨업 계산 및 처리

- [⚠️] **무기 시스템 확장**
  - [x] 직선탄 무기 구현
  - [ ] 방어막 시스템 구현
  - [⚠️] 무기 레벨업 및 효과 증가 (UI만 완성, 게임 엔진 연동 필요)

- [x] **UI 시스템 구현**
  - [x] 상태바 (HP, 레벨, 점수) React 컴포넌트
  - [x] 체력바/경험치바 구현
  - [x] 스킬 아이콘 표시 시스템

#### 우선순위 2 (P2) - 주요 기능
- [⚠️] **업그레이드 시스템**
  - [x] 레벨업 시 게임 일시정지
  - [x] 3가지 업그레이드 선택 UI
  - [⚠️] 업그레이드 효과 적용 (부분적 구현, 일부 연동 필요)

- [⚠️] **게임 상태 관리**
  - [x] 게임 일시정지/재개
  - [⚠️] 게임오버 조건 처리 (감지는 되나 UI 연동 미완)
  - [x] 승리 조건 처리 (15분 생존)

### 3주차: 메타 시스템 및 데이터 (Week 3)
**목표**: 유물 시스템과 진행 데이터 관리

#### 우선순위 1 (P1) - 필수 구현
- [ ] **유물 시스템**
  - [ ] 기본 유물 8-10개 설계 및 구현
  - [ ] 클리어 시 유물 선택 UI
  - [ ] 유물 효과 적용 시스템

- [ ] **난이도 시스템**
  - [ ] 클리어 시 적 스탯 25% 증가
  - [ ] 난이도별 적 스폰 조정
  - [ ] 진행도에 따른 밸런싱

#### 우선순위 2 (P2) - 주요 기능
- [ ] **데이터 저장/로드**
  - [ ] LocalStorage 기반 저장 시스템
  - [ ] 게임 진행 데이터 (클리어 횟수, 보유 유물)
  - [ ] 통계 데이터 (최고 기록, 플레이 시간)

- [ ] **메인 메뉴 시스템**
  - [ ] 게임 시작/계속/설정 메뉴
  - [ ] 유물 보관함 UI
  - [ ] 통계 화면

### 4주차: 모바일 최적화 및 폴리싱 (Week 4)
**목표**: 모바일 앱 변환 및 최종 최적화

#### 우선순위 1 (P1) - 필수 구현
- [ ] **모바일 UI 최적화**
  - [ ] 터치 타겟 크기 조정 (44px+ 기준)
  - [ ] 안전 영역 처리 (iOS 노치, Android 네비게이션)
  - [ ] 터치 지연 방지 설정

- [ ] **성능 최적화**
  - [ ] 오브젝트 풀링 구현
  - [ ] 화면 밖 오브젝트 렌더링 스킵
  - [ ] 30fps 제한 적용

#### 우선순위 2 (P2) - 부가 기능
- [ ] **Capacitor 설정**
  - [ ] 기본 Capacitor 프로젝트 설정
  - [ ] 안드로이드/iOS 빌드 테스트
  - [ ] 네이티브 기능 (햅틱 피드백) 추가

- [ ] **최종 폴리싱**
  - [ ] 사운드 시스템 (선택사항)
  - [ ] 파티클 효과 개선
  - [ ] 밸런싱 조정

## 🛠 기술적 구현 세부사항

### 아키텍처 설계
```
src/
├── components/           # React UI 컴포넌트
│   ├── GameCanvas.tsx   # PixiJS 캔버스 래퍼
│   ├── HUD.tsx          # 상태바, 진행바
│   ├── UpgradePanel.tsx # 레벨업 선택 UI
│   └── MainMenu.tsx     # 메인 메뉴
├── game/                # 게임 로직 (PixiJS)
│   ├── GameEngine.ts    # 메인 게임 엔진
│   ├── entities/        # 플레이어, 적, 투사체
│   ├── systems/         # 충돌, 무기, 경험치 시스템
│   └── managers/        # 씬, 입력, 오브젝트 매니저
├── data/                # 게임 데이터
│   ├── weapons.ts       # 무기 정보
│   ├── upgrades.ts      # 업그레이드 정보
│   └── artifacts.ts     # 유물 정보
└── utils/               # 유틸리티
    ├── storage.ts       # LocalStorage 래퍼
    └── constants.ts     # 게임 상수
```

### 핵심 클래스 설계
```typescript
// GameEngine: 메인 게임 루프 관리
class GameEngine {
  private app: PIXI.Application
  private player: Player
  private enemies: Enemy[]
  private weapons: Weapon[]
  
  update(deltaTime: number): void
  render(): void
  handleInput(input: InputData): void
}

// Player: 플레이어 엔티티
class Player {
  position: Vector2
  health: number
  level: number
  experience: number
  
  moveTo(target: Vector2): void
  takeDamage(damage: number): void
  addExperience(amount: number): void
}

// WeaponSystem: 무기 관리 시스템
class WeaponSystem {
  orbital: OrbitalWeapon    // 궤도탄
  projectile: ProjectileWeapon  // 직선탄
  shield: ShieldWeapon      // 방어막
  
  update(deltaTime: number): void
  upgradeWeapon(type: WeaponType, level: number): void
}
```

### 모바일 최적화 전략
1. **터치 최적화**: 44px+ 터치 타겟, 300ms 지연 방지
2. **성능 최적화**: 오브젝트 풀링, 30fps 제한, 화면 밖 컬링
3. **UI 반응형**: 375px 기준, CSS Grid/Flexbox 활용
4. **배터리 최적화**: requestAnimationFrame 제한, 백그라운드 일시정지

## ⚠️ 주요 리스크 및 대응방안

### 기술적 리스크
1. **PixiJS-React 통합 복잡성**
   - 대응: 단순한 ref 기반 통합, 이벤트 시스템 분리
2. **모바일 성능 이슈**
   - 대응: 실기기 테스트, 프로파일링, 적극적 최적화
3. **터치 입력 정확성**
   - 대응: 관대한 터치 영역, 시각적 피드백 강화

### 개발 리스크
1. **일정 지연 가능성**
   - 대응: MVP 기능 우선, P2 기능 후순위
2. **밸런싱 어려움**
   - 대응: 데이터 기반 조정, 플레이 테스트 반복

## 📈 성공 지표

### 개발 완료 기준
- [ ] 15분 완주 가능한 게임 루프
- [ ] 3가지 무기 시스템 완전 동작
- [ ] 유물 시스템으로 메타 진행 구현
- [ ] 모바일 기기에서 30fps 이상 유지
- [ ] Capacitor 앱 빌드 성공

### 품질 기준
- [ ] 터치 입력 100ms 이내 반응
- [ ] 메모리 누수 없이 30분+ 플레이 가능
- [ ] 다양한 모바일 기기 호환성 확보

이 계획서를 바탕으로 단계별 개발을 진행하며, 각 주차별 목표를 달성하여 최종적으로 모바일 최적화된 뱀파이어 서바이벌 게임을 완성합니다.