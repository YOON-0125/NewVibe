# Enemy-basic.md - 1단계 기본 다양성 적들

## 🎯 구현 대상 적군

### 1. 추적자 (Chaser)
- **외형**: 🟠 주황 원형 (14x14px)
- **특징**: 빠른 속도, 지능적 추적
- **역할**: 플레이어에게 압박감 제공

### 2. 거인 (Giant)  
- **외형**: 🟫 갈색 사각형 (32x32px)
- **특징**: 높은 체력, 느린 속도, 죽을 때 분열
- **역할**: 고가치 타겟, 위치 차단

### 3. 저격수 (Sniper)
- **외형**: 🔷 파란 다이아몬드 (12x12px)  
- **특징**: 원거리 공격, 거리 유지
- **역할**: 원거리 위협, 이동 강제

## 🔧 핵심 기술적 구현 포인트

### 추적자 - 지능형 경로탐색

**주요 기술적 도전:**
1. **벽 충돌 회피 시스템**
   - 단순 직진하다가 벽에 끼이는 문제 해결 필요
   - 벽 감지 후 우회 경로 계산 알고리즘 구현
   - 성능: 매 프레임 경로 계산하면 CPU 부하 → 격 프레임 또는 거리 기반 업데이트

2. **플레이어 예측 이동**
   - 플레이어 현재 위치가 아닌 예상 위치로 이동
   - 플레이어 velocity 기반 0.3-0.5초 후 위치 예측
   - 주의: 과도한 예측은 부자연스러움, 적당한 수준 유지

3. **추적 범위 제한**
   - 무한 추적 시 플레이어가 화면 끝까지 끌려감
   - 추적 시작 거리와 추적 포기 거리 다르게 설정 (히스테리시스)
   - 추적 포기 후 원래 위치 복귀 또는 순찰 패턴

**성능 최적화 포인트:**
- 경로 계산을 매 프레임 하지 말고 0.1초마다 또는 방향 변경이 필요할 때만
- 화면 밖 추적자는 단순 직진으로 전환
- 플레이어와 거리 150px 이상시 AI 업데이트 빈도 감소

### 거인 - 분열 시스템

**주요 기술적 도전:**
1. **분열 스폰 위치 계산**
   - 거인 죽는 위치에서 작은 적들이 겹치지 않게 배치
   - 원형 또는 격자 패턴으로 배치, 벽과 충돌하지 않는 위치 찾기
   - 분열된 적들이 서로 밀어내는 물리 시뮬레이션 필요할 수 있음

2. **분열 개수 제한**
   - 거인 1마리 → 기본 적 4마리 분열 시 적 수가 기하급수적 증가
   - 현재 화면 적 수에 따른 동적 분열 개수 조정
   - 메모리 및 성능 한계 고려한 최대 적 수 제한

3. **체력 스케일링**
   - NG+ 시스템에서 거인 체력이 너무 높아지면 지루함
   - 체력 증가 대신 분열 개수 증가 또는 분열된 적의 능력 강화 고려
   - 플레이어 무기 레벨에 따른 상대적 체력 조정

**밸런싱 고려사항:**
- 거인 1마리 = 기본 적 몇 마리와 같은 위협도인가?
- 분열 후 기본 적들의 행동 패턴 (즉시 추적 vs 잠시 멍함)
- 거인 처치 시 경험치 보상 (분열 적 처치 보상과 균형)

### 저격수 - 원거리 공격 시스템

**주요 기술적 도전:**
1. **투사체 시스템 구축**
   - 투사체 오브젝트 풀링 (매번 생성/삭제하면 GC 부하)
   - 투사체 충돌 감지 (선분과 원/사각형 충돌)
   - 투사체 생명주기 관리 (화면 밖으로 나가면 제거)

2. **거리 유지 AI**
   - 플레이어와 최적 거리 유지 (너무 가까우면 후퇴, 너무 멀면 접근)
   - 후퇴 시 벽이나 다른 적과 충돌 처리
   - 플레이어가 빠르게 접근할 때의 긴급 회피 패턴

3. **조준 시스템**
   - 플레이어 현재 위치가 아닌 예상 위치로 조준
   - 조준선 또는 예고 표시를 통한 플레이어 경고
   - 조준 정확도 설정 (100% 명중하면 너무 어려움)

4. **공격 쿨다운 관리**
   - 공격 간격 동안의 상태 관리 (조준 중, 재장전 중 등)
   - 쿨다운 중 플레이어 접근 시 행동 패턴
   - 시각적 피드백 (충전 상태, 공격 준비 완료 등)

**성능 최적화 포인트:**
- 투사체는 오브젝트 풀 사용 (최대 50-100개 제한)
- 화면 밖 투사체 즉시 제거
- 저격수가 많을 때 동시 발사 제한 (프레임 드롭 방지)

## 🎨 시각적 구분 및 피드백

### 추적자 시각적 요소
- **이동 표시**: 약간의 트레일 이펙트로 빠른 이동감 표현
- **추적 상태**: 색상 변화 (평상시 주황 → 추적 시 빨강-주황 깜빡임)
- **벽 충돌**: 벽에 닿으면 잠깐 밝아졌다가 방향 전환

### 거인 시각적 요소  
- **체력 표시**: 크기가 크므로 HP바 표시 고려
- **분열 예고**: 죽기 직전 깜빡임 또는 균열 표시
- **분열 이펙트**: 죽을 때 폭발 또는 분산 애니메이션

### 저격수 시각적 요소
- **조준 표시**: 플레이어 방향으로 얇은 선 또는 점선
- **공격 예고**: 발사 0.5초 전 색상 변화 또는 확대
- **쿨다운 상태**: 공격 후 색상이 어두워졌다가 점점 밝아짐

## 📊 스폰 및 밸런싱 시스템

### 시간대별 등장 비율
```
0-2분 (기본 적응 구간):
- 기본 적(자살 러시): 80%
- 추적자: 20%
- 거인, 저격수: 0%

2-5분 (난이도 상승):
- 기본 적: 50%  
- 추적자: 30%
- 거인: 15%
- 저격수: 5%

5분+ (최종 난이도):
- 기본 적: 30%
- 추적자: 35%  
- 거인: 20%
- 저격수: 15%
```

### NG+ 시스템 적용
- **체력**: 기본 배수 적용 (1.25^n)
- **속도**: 추적자만 1.1배, 나머지는 속도 증가 없음 (밸런스 붕괴 방지)
- **공격력**: 저격수 투사체 데미지만 증가
- **특수 능력**: 거인 분열 개수 증가 (최대 6마리까지)

## ⚠️ 구현 시 주의사항

### 성능 관련
- **AI 업데이트 분산**: 한 프레임에 모든 적 AI 업데이트 금지
- **거리 기반 최적화**: 화면 밖 적들은 단순화된 AI 사용
- **충돌 검사 최적화**: 공간 분할 또는 거리 기반 1차 필터링

### 밸런싱 관련  
- **추적자 속도**: 플레이어보다 약간 빠르지만 완전히 따라잡지는 못하는 수준
- **거인 분열**: 분열된 적들이 한 곳에 몰리지 않도록 초기 속도 분산
- **저격수 명중률**: 70-80% 수준으로 설정 (100% 시 좌절감)

### 기술적 안정성
- **메모리 누수**: 죽은 적, 투사체 정리 확실히
- **무한 루프**: 경로 탐색 시 최대 반복 횟수 제한
- **상태 동기화**: 여러 적이 동시에 상태 변경 시 충돌 방지

## 🔍 테스트 체크리스트

### 추적자 테스트
- [ ] 벽 근처에서 끼이지 않고 우회하는가?
- [ ] 플레이어가 빠르게 이동해도 적절히 추적하는가?
- [ ] 화면 경계에서 이상 행동하지 않는가?
- [ ] 20마리 이상일 때 성능 문제 없는가?

### 거인 테스트  
- [ ] 분열 시 적들이 겹치지 않게 배치되는가?
- [ ] 분열된 적 수가 예상한 만큼인가?
- [ ] 벽 근처에서 죽어도 분열이 정상 작동하는가?
- [ ] NG+ 높은 단계에서도 적절한 시간에 죽는가?

### 저격수 테스트
- [ ] 투사체가 플레이어 예상 위치로 발사되는가?
- [ ] 거리 유지가 적절히 이루어지는가?
- [ ] 공격 예고가 적절한 타이밍에 표시되는가?
- [ ] 투사체가 화면 밖에서 정리되는가?
- [ ] 여러 저격수가 동시에 있어도 성능 문제 없는가?

이 문서의 모든 기술적 포인트를 구현한 후, 2단계 공격 패턴 적들로 넘어갈 것.